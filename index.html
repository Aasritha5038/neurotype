<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>NeuroType – Cognitive Typing Test</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>

<style>
body{
  margin:0;
  font-family:Roboto,sans-serif;
  background:linear-gradient(135deg,#1e3c72,#2a5298);
  min-height:100vh;
  display:flex;
  justify-content:center;
  align-items:center;
  color:#fff;
}
.container{
  max-width:900px;
  width:95%;
  background:rgba(255,255,255,0.12);
  padding:30px;
  border-radius:16px;
}
.card{
  background:rgba(255,255,255,.15);
  padding:20px;
  border-radius:12px;
  margin-bottom:15px;
}
textarea,input{
  width:100%;
  padding:14px;
  border-radius:8px;
  border:none;
  font-size:16px;
}
textarea{height:160px;}
button{
  margin-top:15px;
  padding:12px 25px;
  border:none;
  border-radius:8px;
  background:#ff9800;
  color:#fff;
  font-weight:bold;
  cursor:pointer;
}
button:hover{background:#ffb300;}
#result{font-size:16px;line-height:1.6;}
</style>
</head>

<body>

<div class="container">
<h1 style="text-align:center;">NeuroType</h1>
<p style="text-align:center;opacity:.85;">Advanced Brain & Typing Focus Assessment</p>

<input id="name" placeholder="Enter your full name">

<div class="card">
<p id="paragraph"></p>
</div>

<div class="card">
⏱ Time Left: <b><span id="time">120</span> sec</b>
<textarea id="typing" placeholder="Type the paragraph above exactly..."></textarea>
<button onclick="finish()">Finish Test</button>
</div>

<div class="card" id="result"></div>

<div class="card" id="cert" style="display:none;text-align:center;">
<button onclick="downloadPDF()">Download Certificate</button>
</div>
</div>

<script>
/* ---------------- PARAGRAPH ---------------- */
const paragraph =
"Typing under focused conditions strengthens cognitive coordination, memory retention, and attention control. This assessment evaluates typing speed, accuracy, and mental endurance under time constraints.";

document.getElementById("paragraph").innerText = paragraph;

/* ---------------- TIMER ---------------- */
let time = 120;
let started = false;
let timer;

const typing = document.getElementById("typing");

typing.addEventListener("focus", ()=>{
  if(!started){
    started = true;
    timer = setInterval(()=>{
      time--;
      document.getElementById("time").innerText = time;
      if(time <= 0) finish();
    },1000);
  }
});

/* ---------------- RESULT DATA ---------------- */
let wpm=0, accuracy=0, brain=0, grade="", certID="";

function generateCertID(){
  return "NT-" + new Date().getFullYear() + "-" + Math.floor(100000 + Math.random()*900000);
}

/* ---------------- FINISH ---------------- */
function finish(){
  clearInterval(timer);
  typing.disabled = true;

  const typed = typing.value.trim();
  const name = document.getElementById("name").value || "Candidate";

  const totalWords = paragraph.split(" ").length;
  const typedWords = typed.length ? typed.split(" ").length : 0;

  accuracy = Math.min(100, Math.round((typedWords / totalWords) * 100));
  const timeSpent = Math.max(1, 120 - time);
  wpm = Math.round((typedWords / timeSpent) * 60);
  brain = Math.round((accuracy + wpm) / 2);

  grade = "Good";
  if(brain > 85) grade = "Excellent";
  else if(brain > 70) grade = "Very Good";

  certID = generateCertID();

  document.getElementById("result").innerHTML = `
  <b>Name:</b> ${name}<br>
  <b>Typing Speed:</b> ${wpm} WPM<br>
  <b>Accuracy:</b> ${accuracy}%<br>
  <b>Brain Score:</b> ${brain}<br>
  <b>Grade:</b> ${grade}<br>
  <b>Certificate ID:</b> ${certID}
  `;

  document.getElementById("cert").style.display = "block";
}

/* ---------------- PDF CERTIFICATE ---------------- */
function downloadPDF(){
  const { jsPDF } = window.jspdf;
  const doc = new jsPDF("landscape","px",[900,600]);

  /* Background */
  doc.setFillColor(245,247,255);
  doc.rect(0,0,900,600,"F");

  /* Borders */
  doc.setDrawColor(30,60,114);
  doc.setLineWidth(6);
  doc.rect(20,20,860,560);
  doc.setLineWidth(2);
  doc.rect(40,40,820,520);

  /* Header */
  doc.setFontSize(32);
  doc.text("CERTIFICATE OF COGNITIVE TYPING",450,120,{align:"center"});

  /* Name */
  const name = document.getElementById("name").value || "Candidate";
  doc.setFontSize(26);
  doc.text(name,450,190,{align:"center"});

  doc.setFontSize(18);
  doc.text("has successfully completed the NeuroType Assessment",450,225,{align:"center"});

  /* Results */
  doc.setFontSize(17);
  doc.text(`Typing Speed : ${wpm} WPM`,450,280,{align:"center"});
  doc.text(`Accuracy : ${accuracy}%`,450,310,{align:"center"});
  doc.text(`Brain Score : ${brain}`,450,340,{align:"center"});
  doc.text(`Grade : ${grade}`,450,370,{align:"center"});

  /* Footer */
  doc.setFontSize(14);
  doc.text(`Certificate ID: ${certID}`,60,520);
  doc.text(`Issued on: ${new Date().toDateString()}`,450,520,{align:"center"});

  /* Signature (text-based – NO IMAGE ERROR) */
  doc.setFontSize(16);
  doc.text("Authorized Signature",700,480);

  doc.save("NeuroType_Certificate.pdf");
}
</script>

</body>
</html>
